<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="4.0" DefaultTargets="Build">
	<Target Name="DoLocalDeploy" Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
	
		<!-- Declare skin files -->
		<ItemGroup>
			<DeploySkinFiles Include="..\R7.Epsilon\Skins\**\*.ascx" />
			<DeploySkinFiles Include="..\R7.Epsilon\Skins\**\*.xml" />
			<DeploySkinFiles Include="..\R7.Epsilon\Skins\**\*.css" />
			<DeploySkinFiles Include="..\R7.Epsilon\Skins\**\*.resx" />
			<DeploySkinFiles Include="..\R7.Epsilon\Skins\**\*.js" />
			<DeploySkinFiles Include="..\R7.Epsilon\Skins\**\*.jpg" />
			<DeploySkinFiles Include="..\R7.Epsilon\Skins\**\*.png" />
			<DeploySkinFiles Include="..\R7.Epsilon\Skins\**\*.gif" />
		</ItemGroup>

		<!-- Declare container files -->
		<ItemGroup>
			<DeployContainerFiles Include="..\R7.Epsilon\Containers\**\*.ascx" />
			<DeployContainerFiles Include="..\R7.Epsilon\Containers\**\*.css" />
			<DeployContainerFiles Include="..\R7.Epsilon\Containers\**\*.resx" />
			<DeployContainerFiles Include="..\R7.Epsilon\Containers\**\*.js" />
			<DeployContainerFiles Include="..\R7.Epsilon\Containers\**\*.jpg" />
			<DeployContainerFiles Include="..\R7.Epsilon\Containers\**\*.png" />
			<DeployContainerFiles Include="..\R7.Epsilon\Containers\**\*.gif" />
		</ItemGroup>

		<!-- Declare menu files -->
		<ItemGroup>
			<DeployMenuFiles Include="..\R7.Epsilon\Menu\**\*.css" />
			<DeployMenuFiles Include="..\R7.Epsilon\Menu\**\*.js" />
			<DeployMenuFiles Include="..\R7.Epsilon\Menu\**\*.xml" />
			<DeployMenuFiles Include="..\R7.Epsilon\Menu\**\*.xslt" />
		</ItemGroup>

		<!-- Copy files to tmp dirs -->
		<Copy SourceFiles="@(DeploySkinFiles)" DestinationFolder="$(MSBuildProjectDirectory)\tmp_Skins\%(RecursiveDir)" />
		<Copy SourceFiles="@(DeployContainerFiles)" DestinationFolder="$(MSBuildProjectDirectory)\tmp_Containers\%(RecursiveDir)" />
		<Copy SourceFiles="@(DeployMenuFiles)" DestinationFolder="$(MSBuildProjectDirectory)\tmp_Menu\%(RecursiveDir)" />
		
		<!-- declare files to move -->
		<ItemGroup>
			<SkinMoveFiles Include="$(MSBuildProjectDirectory)\tmp_Skins\**\*.*" />	
		</ItemGroup>
	
		<ItemGroup>	
			<ContainerMoveFiles Include="$(MSBuildProjectDirectory)\tmp_Containers\**\*.*" />
		</ItemGroup>
	
		<ItemGroup>
			<MenuMoveFiles Include="$(MSBuildProjectDirectory)\tmp_Menu\**\*.*" />
		</ItemGroup>

		<!-- Deploy files -->
		<Move SourceFiles="@(SkinMoveFiles)" DestinationFolder="$(DnnSkinsPath)\R7.Epsilon\%(RecursiveDir)" />
		<Move SourceFiles="@(ContainerMoveFiles)" DestinationFolder="$(DnnContainersPath)\R7.Epsilon\%(RecursiveDir)" />
		<Move SourceFiles="@(MenuMoveFiles)" DestinationFolder="$(DnnMenusPath)\Mega2Epsilon\%(RecursiveDir)" />

		<!-- Copy binary -->
		<Copy SourceFiles="$(MSBuildDnnBinPath)\R7.Epsilon.dll" DestinationFolder="$(DnnBinPath)" />

		<!-- Cleanup -->
		<RemoveDir Directories="$(MSBuildProjectDirectory)\tmp_Skins" />
		<RemoveDir Directories="$(MSBuildProjectDirectory)\tmp_Containers" />
		<RemoveDir Directories="$(MSBuildProjectDirectory)\tmp_Menu" />

	</Target>
</Project>
